import{u,j as e}from"./index-2vrD73m2.js";import{r as a}from"./react-vendor-DRM3MNr6.js";import"./supabase-g_Un6fVd.js";const v=()=>{const{currentUser:d,stockMovements:m,products:x}=u(),i=a.useMemo(()=>d?m.filter(r=>r.movementType==="exit"&&r.userId===d.id):[],[m,d]),c=a.useMemo(()=>{const r=i.reduce((t,n)=>t+n.quantity,0),o=i.length,s={};i.forEach(t=>{s[t.productId]||(s[t.productId]={quantity:0,product:x.find(n=>n.id===t.productId)}),s[t.productId].quantity+=t.quantity});const l=Object.entries(s).sort(([,t],[,n])=>n.quantity-t.quantity).slice(0,10);return{totalQuantity:r,totalExits:o,topProducts:l}},[i,x]),p=a.useMemo(()=>[...i].sort((r,o)=>new Date(o.timestamp).getTime()-new Date(r.timestamp).getTime()).slice(0,10),[i]);return d?e.jsxs("div",{style:{padding:"2rem"},children:[e.jsx("h1",{style:{marginBottom:"2rem",color:"var(--text-color)"},children:"Mes Statistiques"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{background:"var(--card-bg)",padding:"1.5rem",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:"Total des sorties"}),e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--accent-color)"},children:c.totalExits})]}),e.jsxs("div",{style:{background:"var(--card-bg)",padding:"1.5rem",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontSize:"0.9rem",color:"var(--text-secondary)",marginBottom:"0.5rem"},children:"Articles consommÃ©s"}),e.jsx("div",{style:{fontSize:"2.5rem",fontWeight:"700",color:"var(--accent-color)"},children:c.totalQuantity})]})]}),e.jsxs("div",{style:{background:"var(--card-bg)",padding:"1.5rem",borderRadius:"12px",border:"1px solid var(--border-color)",marginBottom:"2rem"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.25rem",color:"var(--text-color)"},children:"Top 10 des produits consommÃ©s"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:c.topProducts.length===0?e.jsx("p",{style:{color:"var(--text-secondary)",textAlign:"center"},children:"Aucune consommation enregistrÃ©e"}):c.topProducts.map(([r,o],s)=>{var l,t;return e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",padding:"1rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{width:"32px",height:"32px",borderRadius:"50%",background:"var(--accent-color)",color:"white",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"700",fontSize:"0.9rem"},children:s+1}),o.product&&o.product.photo?e.jsx("img",{src:o.product.photo,alt:o.product.designation,style:{width:"50px",height:"50px",objectFit:"cover",borderRadius:"8px"}}):e.jsx("div",{style:{width:"50px",height:"50px",borderRadius:"8px",background:"var(--hover-bg)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.5rem"},children:"ðŸ“¦"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:"600",color:"var(--text-color)",marginBottom:"0.25rem"},children:((l=o.product)==null?void 0:l.designation)||"Produit inconnu"}),e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:(t=o.product)==null?void 0:t.reference})]}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:"700",color:"var(--accent-color)"},children:o.quantity})]},r)})})]}),e.jsxs("div",{style:{background:"var(--card-bg)",padding:"1.5rem",borderRadius:"12px",border:"1px solid var(--border-color)"},children:[e.jsx("h2",{style:{marginBottom:"1.5rem",fontSize:"1.25rem",color:"var(--text-color)"},children:"DerniÃ¨res sorties"}),e.jsx("div",{style:{overflowX:"auto"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{borderBottom:"2px solid var(--border-color)"},children:[e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Date"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"left",color:"var(--text-secondary)",fontSize:"0.9rem"},children:"Produit"}),e.jsx("th",{style:{padding:"0.75rem",textAlign:"right",color:"var(--text-secondary)",fontSize:"0.9rem"},children:"QuantitÃ©"})]})}),e.jsx("tbody",{children:p.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,style:{padding:"2rem",textAlign:"center",color:"var(--text-secondary)"},children:"Aucune sortie enregistrÃ©e"})}):p.map(r=>e.jsxs("tr",{style:{borderBottom:"1px solid var(--border-color)"},children:[e.jsx("td",{style:{padding:"0.75rem",color:"var(--text-color)"},children:new Date(r.timestamp).toLocaleDateString("fr-FR")}),e.jsxs("td",{style:{padding:"0.75rem"},children:[e.jsx("div",{style:{fontWeight:"500",color:"var(--text-color)",marginBottom:"0.25rem"},children:r.productDesignation}),e.jsx("div",{style:{fontSize:"0.85rem",color:"var(--text-secondary)"},children:r.productReference})]}),e.jsx("td",{style:{padding:"0.75rem",textAlign:"right",fontWeight:"600",color:"var(--accent-color)"},children:r.quantity})]},r.id))})]})})]})]}):null};export{v as default};
